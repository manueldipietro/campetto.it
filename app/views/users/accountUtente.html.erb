<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width,initial-scale=1">
		<title>Campetto</title>
	</head>
	<body>
  <!-- NavBar -->
    <nav class="navbar navbar-expand-lg fixed-top">
    <div class="container-fluid">
        <%= link_to "Campetto.it", root_path, class: "navbar-brand" %>
        <div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasNavbar" aria-labelledby="offcanvasNavbarLabel">
        <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="offcanvasNavbarLabel">Campetto.it</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
        </div>
        <div class="offcanvas-body">
            <ul class="navbar-nav justify-content-center flex-grow-1 pe-3">
            <li class="nav-item">
                <a class="nav-link mx-lg-2 active" aria-current="page" href="#">Home</a>
            </li>
            <li class="nav-item">
                <a class="nav-link mx-lg-2" href="#">Contatti</a>
            </li>
            <% unless current_user %>
            <li class="nav-item">
                <a class="nav-link mx-lg-2" href="#">Gestisci un Campo?</a>
            </li>
            <% end %>
            </ul>

            <% if current_user %>
            <button class="button w-100 d-lg-none mt-3" id="accountBtn" onclick="window.location='<%= root_path %>'">Prenota</button>
            <% else %>
            <button class="button w-100 d-lg-none mt-3" id="signupBtn" onclick="window.location='<%= logReg_path(form: 'signup') %>'">Registrati</button>
            <% end %>
        </div>
        </div>

        <div>
        <% if current_user %>
            <%= button_to 'Logout', logout_path, method: :delete, class: 'buttonlogin' %>
            <button class="button d-none d-lg-inline" id="accountBtn" onclick="window.location='<%= root_path %>'">Prenota</button>
        <% else %>
            <button class="buttonlogin" id="loginBtn" onclick="window.location='<%= logReg_path(form: 'login') %>'">Accedi</button>
            <button class="button d-none d-lg-inline" id="signupBtn" onclick="window.location='<%= logReg_path(form: 'signup') %>'">Registrati</button>
        <% end %>
        
        <button class="navbar-toggler ps-2 pe-2" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasNavbar" aria-controls="offcanvasNavbar" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        </div>
    </div>
    </nav>
    <section class="mainAccount">
      <div class="container">
        <div class="user-info">
          <% if @user %>
            <h1>Ciao <%= @user.email %>!</h1>
            <p>Benvenuto nella tua dashboard.</p>
            <p><strong>Email:</strong> <%= @user.email %></p>
            <!-- Aggiungi altre informazioni personali se necessario -->
          <% else %>
            <p>Non riesco a trovare l'utente. Potresti non essere loggato.</p>
          <% end %>
        </div>

        <div class="user-menu">
          <ul>
            <li><a href="<%= bookings_path %>">Prenotazioni</a></li>
            <li><a href="#">Recensioni</a></li>
            <li><a href="#">Segnalazioni</a></li>
            <li><a href="#">Edita Profilo</a></li>
            <li><a href="#" id="changePassw">Cambia Password</a></li>
            <li><a href="#">Elimina Profilo</a></li>
          </ul>
        </div>
      </div>
      <div id="blur-background" class="blur-background"></div>
      <div id="form__changepassword" class="form__password">
            <div class="form__box login">
            <span class="close-btn">&times;</span>
                <div class="form__content">
                    <h2>Cambia password</h2>
                    <%= form_with url: modify_password_path, method: :post, remote: true, id: "changePasswordForm",onsubmit: "return validatePassw()" do |f| %>
                          <div class="input__field">
                            <%= f.password_field :password_login, id: "password_login", required: true, class: "form-control" %>
                            <label for="password_login">Password Corrente</label>
                            <i id="occhioLogin" class="fa-solid fa-eye mostra__pass" onclick="mostraPasswordLogin()"></i>
                          </div>

                          <div class="input__field">
                            <%= f.password_field :password, id: "signup_password", onkeyup: "checkPassword()", required: true, class: "form-control" %>
                            <label for="signup_password">Nuova password</label>
                            <i id="occhioReg" class="fa-solid fa-eye mostra__pass" onclick="mostraPassword()"></i>

                            <!-- Lista dei requisiti della password -->
                            <div class="pass__checklist">
                                <h4 class="titolo_check">La password deve:</h4>
                                <ul class="checklist">
                                    <li id="lunghezza" class="condizione">Essere lunga almeno 8 caratteri.</li>
                                    <li id="maiuscole" class="condizione">Avere almeno una maiuscola.</li>
                                    <li id="numeri" class="condizione">Avere almeno un numero.</li>
                                    <li id="speciale" class="condizione">Avere almeno un carattere speciale.</li>
                                </ul>
                            </div>
                          </div>

                          <div class="input__field">
                            <%= f.password_field :conferma_password, id: "conferma_password", required: true, class: "form-control" %>
                            <label for="conferma_password">Conferma nuova password</label>
                            <i id="occhioConf" class="fa-solid fa-eye mostra__pass" onclick="mostraPasswordConf()"></i>
                          </div>
                          <% if flash[:notice] %>
                              <div class="alert alert-success">
                                  <%= flash[:notice] %>
                              </div>
                          <% end %>
                          <% if flash[:alert] %>
                              <div class="alert alert-danger alert-small">
                                  <%= flash[:alert] %>
                              </div>
                          <% end %>
                          <div>
                            <%= f.submit "Cambia Password",class:'buttonCerca' %>
                          </div>
                    <% end %>                   
                    <div id="error_msg_reset" style="color: red;"></div>
                </div>
            </div>
        </div>
    </section>
    <!-- FINE PAGINA -->
    <div class="fine__container" id="terms">
      <div class="fine__links">
        <div class="fine__link--wrapper">
        <div class="fine__link--items">
            <h2>About Us</h2>
            <a href="#nostraidea">La nostra idea</a> 
            <a href="#chisiamo">Chi siamo</a> 
            <a href="#terms">Terms of Service</a>
        </div>
        <div class="fine__link--items">
            <h2>Follow us </h2>
            <a href="https://www.facebook.com" target="_blank">Facebook <i class="fa fa-facebook"></i></a>
            <a href="https://www.instagram.com" target="_blank">Instagram <i class="fa fa-instagram"></i></a>
            <a href="https://www.twitter.com" target="_blank">Twitter <i class="fa fa-twitter"></i></a>
            <a href="https://www.linkedin.com" target="_blank">LinkedIn <i class="fa fa-linkedin"></i></a>
        </div>
      </div>
    </div>
    <section class="social__media">
        <div class="social__media--wrap">
        <div class="fine__logo">
            <a class="fine-brand me-auto" href="#">Campetto.it</a>
        </div>
        <p class="website__rights">Â© Campetto.it 2024. All rights reserved</p>
        </div>
    </section>
    <script>
      document.addEventListener("DOMContentLoaded", function() {
        <% if flash[:show_popup] %>
          document.getElementById('form__changepassword').style.display = 'block';
          document.getElementById('blur-background').style.display = 'block';
        <% end %>
      });
    </script>
  </body>
</html>