<%= stylesheet_link_tag 'reviews_index', media: 'all' %>

<div class="reviews-wrapper">
  <h1 class="title">Recensioni per <%= @field.nome %></h1>

  <% if current_user %>
    <%= link_to 'Aggiungi una Recensione', new_field_review_path(@field), class: 'btn btn-primary' %>
  <% else %>
    <p>Devi essere loggato per aggiungere una recensione. <%= link_to 'Accedi', login_path %> o <%= link_to 'Registrati', signup_path %>.</p>
  <% end %>

  <div class="reviews-container">
    <% if @reviews.any? %>
      <% @reviews.each do |review| %>
        <div class="review-card">
          <div class="review-header">
            <h2><%= review.titolo %></h2>
          <p>
            <strong>
              <% review.valutazione.times do %>
                <i class="fas fa-star" style="color: gold;"></i>
              <% end %>
              <% (5 - review.valutazione).times do %>
                <i class="far fa-star"></i> 
              <% end %>
            </strong>
          </p>
          </div>
          <div class="review-body">
            <p><%= review.testo %></p>
          </div>
          <div class="review-footer">
            <small>Recensito da: <%= review.user.email %> il <%= review.created_at.strftime('%d/%m/%Y') %></small>
            <% if current_user == review.user %>
              <div class="actions">
                <%= link_to 'Elimina', field_review_path(@field, review), method: :delete, data: { confirm: 'Sei sicuro di voler eliminare questa recensione?' }, class: 'btn btn-danger' %>
              </div>
            <% end %>
          </div>
        </div>
      <% end %>
    <% else %>
      <p>Nessuna recensione disponibile per questo campo.</p>
    <% end %>
  </div>

  <!-- Link per tornare al campo -->
  <%= link_to 'Torna al Campo', field_path(@field), class: 'btn btn-secondary mt-3' %>
</div>

